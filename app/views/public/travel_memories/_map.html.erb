      <div id="header">Google Maps - 場所検索</div>
      <input type="text" id="keyword"><button id="search">検索実行</button>
      <button id="clear">結果クリア</button>
      <div id="target"></div>
      <style>
        #target {
          height: 400px;
          width: 600px}
      </style>

      <script src="https://maps.googleapis.com/maps/api/js?language=ja&region=JP&key=<%= ENV['API_KEY'] %>&callback=initMap" async defer></script>
      <script>
        let map;
        let marker;
        var infoWindow;

        function initMap() {
          //  マップ初期表示の位置設定
          var target = document.getElementById('target');
          var empire = {lat: 34.5801650, lng: 135.4623190};

          // マップ表示
          map = new google.maps.Map(target, {
            center: empire,
            zoom: 8
          });

          document.getElementById('search').addEventListener('click', function() {
            var place = document.getElementById('keyword').value;
            var geocoder = new google.maps.Geocoder();

            geocoder.geocode({
              address: place
            }, function(results, status) {
              if (status == google.maps.GeocoderStatus.OK) {

                var bounds = new google.maps.LatLngBounds();

                for (var i in results) {
                  if (results[0].geometry) {
                    // 緯度経度を取得
                    var latlng = results[0].geometry.location;
                    // 住所を取得
                    var address = results[0].formatted_address;
                    // 検索結果値が含まれるように拡大
                    bounds.extend(latlng);
                    // マーカーのセット
                    setMarker(latlng);
                    // マーカーへの吹き出しの追加
                    setInfoW(place, latlng, address);
                    // マーカーにクリックイベントを追加
                    markerEvent();
                  }
                }
              } else if (status == google.maps.GeocoderStatus.ZERO_RESULTS) {
                alert("見つかりません");
              } else {
                console.log(status);
                 alert('Geocode was not successful for the following reason: ' + status);
              }
            });

          });

          // 検索クリアボタン押下時
          document.getElementById('clear').addEventListener('click', function() {
            deleteMarkers();
          });
        }

        // マーカのセットを実施する
        function setMarker(setplace) {
          deleteMarkers();

          var iconUrl = 'http://maps.google.com/mapfiles/ms/icons/blue-dot.png';
            marker = new google.maps.Marker({
              position: setplace,
              map: map,
              icon: iconUrl
          });
        }
        // マーカを削除する
        function deleteMarkers() {
          if(marker != null){
            marker.setMap(null);
          }
          marker = null;
        }

        // マーカーへの吹き出しの追加
        function setInfoW(place, latlng, address) {
          infoWindow = new google.maps.InfoWindow({
          content: "<a href='http://www.google.com/search?q=" + place + "' target='_blank'>" + place + "</a><br><br>" + latlng + "<br><br>" + address + "<br><br><a href='http://www.google.com/search?q=" + place + "&tbm=isch' target='_blank'>画像検索 by google</a>"
        });
      }


        // クリックイベント
        function markerEvent() {
          marker.addListener('click', function() {
            infoWindow.open(map, marker);
          });
        }
        // var MyLatLng = new google.maps.LatLng(35.6811673, 139.7670516);
        // var Options = {
        // zoom: 15,      //地図の縮尺値
        // center: MyLatLng,    //地図の中心座標
        // mapTypeId: 'roadmap'   //地図の種類
        // };
        // var map = new google.maps.Map(document.getElementById('map'), Options);
      </script>

